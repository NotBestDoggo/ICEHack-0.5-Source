//Deobfuscated with https://github.com/PetoPetko/Minecraft-Deobfuscator3000 using mappings "1.12 stable mappings"!

package me.fluffycq.icehack.module.modules.exploit;

import me.fluffycq.icehack.module.Category;
import me.fluffycq.icehack.module.Module;
import net.minecraft.block.material.Material;
import net.minecraft.block.state.IBlockState;
import net.minecraft.client.settings.KeyBinding;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.RayTraceResult;
import org.lwjgl.input.Keyboard;

public class AntiAnvil extends Module {
  public AntiAnvil() {
    super("AntiAnvil", 0, Category.EXPLOITS);
  }
  
  public void onUpdate() {
    if (mc.player.openContainer != null && mc.player.openContainer instanceof net.minecraft.inventory.ContainerRepair)
      mc.player.closeScreen(); 
    this.tick++;
    if (this.tick >= 2) {
      if (mc.objectMouseOver != null) {
        RayTraceResult rayTraceResult = mc.objectMouseOver;
        if (rayTraceResult.typeOfHit != null && rayTraceResult.typeOfHit == RayTraceResult.Type.BLOCK) {
          BlockPos blockPos = rayTraceResult.getBlockPos();
          IBlockState iBlockState = mc.world.getBlockState(blockPos);
          if (iBlockState.getMaterial() != null && mc.world.getWorldBorder().contains(blockPos))
            if (iBlockState.getMaterial() == Material.ANVIL) {
              KeyBinding.setKeyBindState(mc.gameSettings.keyBindSneak.getKeyCode(), true);
            } else if (iBlockState.getMaterial() != Material.ANVIL && !Keyboard.isKeyDown(mc.gameSettings.keyBindSneak.getKeyCode()) && mc.player.isSneaking()) {
              KeyBinding.setKeyBindState(mc.gameSettings.keyBindSneak.getKeyCode(), false);
            }  
        } else if (!Keyboard.isKeyDown(mc.gameSettings.keyBindSneak.getKeyCode()) && mc.player.isSneaking()) {
          KeyBinding.setKeyBindState(mc.gameSettings.keyBindSneak.getKeyCode(), false);
        } 
      } else if (!Keyboard.isKeyDown(mc.gameSettings.keyBindSneak.getKeyCode()) && mc.player.isSneaking()) {
        KeyBinding.setKeyBindState(mc.gameSettings.keyBindSneak.getKeyCode(), false);
      } 
      this.tick = 0;
    } 
  }
}
